<?xml version="1.0" encoding="utf-8"?>
<service>
    <short><%= @short %></short>
    <%- if @description -%>
    <description><%= @description %></description>
    <%- end -%>

    <%- if @port -%>
    <%- @port.each do |i| -%>
      <%- if i['port'] and i['port'] != '' -%>
    <%- p = sprintf('%s',i['port']).sub(/:/, '-') -%>
    <port<% if i['protocol'] -%> protocol="<%= i['protocol'] %>"<% end -%> port="<%= p %>" />
      <%- else -%>
    <port protocol="<%= i['protocol'] %>" port="" />
      <%- end -%>
    <%- end -%>

    <%- end -%>
    <%- if @module -%>
    <%- @module.sort.each do |j| -%>
    <module name="<%= j %>" />
    <%- end -%>

    <%- end -%>
    <%- if @destination -%>
    <destination<% if @destination['ipv4'] -%> ipv4="<%= @destination['ipv4'] %>"<% end -%><% if @destination['ipv6'] -%> ipv6="<%= @destination['ipv6'] %>"<% end -%> />
    <%- end -%>
</service>
